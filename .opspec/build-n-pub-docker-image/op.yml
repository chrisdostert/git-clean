name: build-n-pub-docker-image
description: releases the package
inputs:
  version:
    string:
      constraints: { format: semver }
  dockerUsername:
    string: {}
  dockerPassword:
    string: {}
  dockerfile:
    file:
      default: .opspec/build-n-pub-docker-image/Dockerfile
run:
  serial:
    - op:
        pkg: { ref: github.com/opspec-pkgs/docker.image.build#1.0.0 }
        inputs: { dockerfile, imageName: 'opspecpkgs/git.clean:$(version)' }
        outputs: { imageTar }
    - op:
        pkg: { ref: github.com/opspec-pkgs/docker.image.push#1.0.0 }
        inputs:
          imageTar:
          imageName: 'opspecpkgs/git.clean:$(version)'
          username: $(dockerUsername)
          password: $(dockerPassword)